######################
## Example: Expose Services via Gateway API
## Copy and modify this for your applications
######################

apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: my-app
  namespace: my-app
  labels:
    hostk8s.app: my-app
spec:
  parentRefs:
  - name: hostk8s-gateway
    namespace: istio-system
  hostnames:
  - "localhost"
  - "my-app.hostk8s.local"
  rules:
  # Simple path-based routing
  - matches:
    - path:
        type: PathPrefix
        value: /my-app
    backendRefs:
    - name: my-service
      port: 8080

  # API endpoints
  - matches:
    - path:
        type: PathPrefix
        value: /api
    backendRefs:
    - name: my-api-service
      port: 8080

  # Health check
  - matches:
    - path:
        type: Exact
        value: /health
    backendRefs:
    - name: my-service
      port: 8080

---
# Access your application at:
# http://localhost:8080/my-app (or whatever port Kind maps to)
#
# Check the Gateway service NodePorts:
# kubectl get service hostk8s-gateway-istio -n istio-system
